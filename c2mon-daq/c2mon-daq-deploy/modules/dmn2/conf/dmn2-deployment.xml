<?xml version="1.0" encoding="UTF-8"?>
<products>
	<product name="c2mon-daq">

		<!--
			this application section is a parent configuration for both
			c2mon-dmn2-prod and c2mon-dmn2-test
		-->
		<application name="default"> 
			<deployment installLocation="/opt/c2mon-daq-dmn2">
				<backupPolicy keepBackups="2">
					<preserve type="dir" name="log" />
				</backupPolicy>
				<notification>
					<!-- you can give more than one mail for deployment notification -->
					<mail address="timdiamon-developers@cern.ch" />
				</notification>
			</deployment>
		<startscript>
			<main-class name="cern.tim.driver.common.startup.DaqStartup" >
				<arg>-timProperties ${C2MON_PROPERTIES_FILE} -log4j ${LOG4J_CONF_FILE} -daqConf ${DAQ_CONF_HOME}/daq.conf -processName ${PROCESS_NAME} ${ADDITIONAL_PARAMS}</arg>
			<preExec>
			<![CDATA[
			[[ -z $C2MON_PROPERTIES_FILE ]] && echo "C2MON_PROPERTIES_FILE not set!" && exit 1
			[[ -z $LOG4J_CONF_FILE ]] && echo "LOG4J_CONF_FILE not set!" && exit 1
			[[ -z $DAQ_CONF_HOME ]] && echo "DAQ_CONF_HOME not set!" && exit 1
			[[ -z $DAQ_LOG_HOME ]] && echo "DAQ_LOG_HOME not set!" && exit 1
			[[ -z $PROCESS_NAME ]] && echo "PROCESS_NAME not set!" && exit 1
			[[ -z $ADDITIONAL_PARAMS ]] && echo "ADDITIONAL_PARAMS not set!" && exit 1
			]]>
			</preExec>
			<property name="daq" value="$PROCESS_NAME"/>
			<property name="tim.log.path" value="$DAQ_LOG_HOME"/>
			</main-class>
		</startscript>
		</application>

		<application name="c2mon-daq-dmn2-prod" extends="default">
		
			<deployment>
				<directory name="conf">
					<file name=".jmxremote.passwd" sourceDir="/user/diamonop/c2mon/prod/conf/"
						mask="400" />
					<file name=".jmxremote.access" sourceDir="/user/diamonop/c2mon/prod/conf/"
						mask="400" />
					<file name=".c2mon.properties" sourceDir="/user/diamonop/c2mon/prod/conf/"
						mask="400" />
				</directory>
			</deployment>
		</application>

		<application name="c2mon-daq-dmn2-test" extends="default" >
			
			<deployment installLocation="/opt/c2mon-dmn2-test">
				<directory name="conf">
					<file name=".jmxremote.passwd" sourceDir="/user/diamonop/c2mon/test/conf/"
						mask="400" />
					<file name=".jmxremote.access" sourceDir="/user/diamonop/c2mon/test/conf/"
						mask="400" />
					<file name=".c2mon.properties" sourceDir="/user/diamonop/c2mon/test/conf/"
						mask="400" />
				</directory>
			</deployment>
		</application>

	</product>
</products>