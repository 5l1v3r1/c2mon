<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
                    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

  <!-- import properties -->
  <import resource="classpath:test-config/server-test-properties.xml"/>

  <!-- datasource & other DB beans -->
  <import resource="classpath:config/server-history-localdb.xml"/>
  <import resource="classpath:config/server-history-mybatis.xml"/>

  <import resource="classpath:config/server-history-tag.xml"/>
  <import resource="classpath:config/server-history-command.xml"/>

  <bean id="logCommandListener" class="cern.c2mon.server.history.listener.LogCommandListener">
    <constructor-arg index="2" ref="commandPersistenceManager"/>
    <constructor-arg index="1" ref="commandExecutionManager"/>
  </bean>
  <bean id="commandExecutionManager" class="org.easymock.EasyMock" factory-method="createMock">
    <constructor-arg>
      <value>cern.c2mon.server.command.CommandExecutionManager</value>
    </constructor-arg>
  </bean>
  <!-- for test only, to check properly inserted -->
  <bean id="commandTagMapper" class="org.mybatis.spring.mapper.MapperFactoryBean">
    <property name="sqlSessionFactory" ref="stlSqlSessionFactory"/>
    <property name="mapperInterface" value="cern.c2mon.server.history.mapper.CommandTagLogMapper"/>
  </bean>


  <bean id="tagLogCacheListener" class="cern.c2mon.server.history.listener.TagHistoryListener">
    <constructor-arg ref="cacheRegistrationService"/>
  </bean>
  <bean id="cacheRegistrationService" class="org.easymock.EasyMock" factory-method="createMock">
    <constructor-arg>
      <value>cern.c2mon.server.cache.CacheRegistrationService</value>
    </constructor-arg>
  </bean>

  <bean id="logSupervisionListener" class="cern.c2mon.server.history.listener.LogSupervisionListener">
    <constructor-arg index="0" ref="supervisonNotifier"/>
    <constructor-arg index="1" ref="supervisionMapper"/>
  </bean>
  <bean id="supervisonNotifier" class="org.easymock.EasyMock" factory-method="createMock">
    <constructor-arg>
      <value>cern.c2mon.server.supervision.SupervisionNotifier</value>
    </constructor-arg>
  </bean>

</beans>
