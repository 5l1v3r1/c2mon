<?xml version="1.0" encoding="UTF-8"?>
<products>
  <product name="tim2-daq-dip">

    <!--
			this application section is a parent configuration for both
			tim2-daq-dip-prod and tim2-daq-dip-test
		-->
    <application name="default">
      <deployment installLocation="/opt/tim2-daq-dip">
        <backupPolicy keepBackups="5">
          <preserve type="dir" name="tmp" />
          <preserve type="dir" name="log" />
          <preserve type="dir" name="conf/local" />
        </backupPolicy>       
      </deployment>
      
      <startscript>
        <env name="LD_LIBRARY_PATH" value="$INSTALL_DIR/lib_so"/>
        <env name="DIM_DNS_NODE" value="dipns1,dipns2"/>
        <env name="DIM_DNS_PORT" value="2506"/>
      
        <main-class name="cern.c2mon.daq.common.startup.DaqStartup">
          <arg>-processName ${PROCESS_NAME} ${ADDITIONAL_PARAMS}</arg>
        </main-class>
        <initial-heap-size>256m</initial-heap-size>
        <max-heap-size>256m</max-heap-size>
        <property name="java.library.path" value="$INSTALL_DIR/lib_so" />
        <preExec>
                    <![CDATA[
                      [[ -z $PROCESS_NAME ]] && echo "PROCESS_NAME not set!" && exit 1
                      [[ -z $ADDITIONAL_PARAMS ]] && echo "ADDITIONAL_PARAMS not set!" && exit 1
                     ]]>
        </preExec>
      </startscript>
    </application>

    <application name="tim2-daq-dip-prod" extends="default">
      <deployment installLocation="/opt/tim2-daq-dip">
         <notification>          
          <mail address="tim-admin@cern.ch" />
        </notification>
        <directory name="conf">
          <file name="c2mon.properties" sourceDir="/user/timoper/rep/c2mon/daq" mask="400" />
          <file name="daq.conf" sourceDir="/user/timoper/rep/c2mon/daq" mask="400" />
        </directory>
        <directory name="bin">
          <file name="daqprocess.sh" sourceDir="/user/timoper/rep/c2mon/daq" mask="700" />
        </directory>
      </deployment>
      <startscript name="TIM2-DAQ-STARTUP">
        <main-class name="cern.c2mon.daq.common.startup.DaqStartup">
          <arg>-processName ${PROCESS_NAME} ${ADDITIONAL_PARAMS}</arg>
        </main-class>
        <property name="c2mon.daq.spring.context" value="classpath:resources/daq-core-service-double.xml" />
      </startscript>
    </application>

    <application name="tim2-daq-dip-test" extends="default">
      <deployment installLocation="/opt/tim2-daq-dip-test">
        <directory name="conf">
          <file name="c2mon.properties" sourceDir="/user/timtest/rep/c2mon/daq" mask="400" />
          <file name="daq.conf" sourceDir="/user/timtest/rep/c2mon/daq" mask="400" />
        </directory>
        <directory name="bin">
          <file name="daqprocess.sh" sourceDir="/user/timtest/rep/c2mon/daq" mask="700" />
        </directory>
      </deployment>
      <startscript name="TIM2-DAQ-STARTUP">
        <main-class name="cern.c2mon.daq.common.startup.DaqStartup">
          <arg>-processName ${PROCESS_NAME} ${ADDITIONAL_PARAMS}</arg>
        </main-class>
      </startscript>
    </application>
  </product>
</products>