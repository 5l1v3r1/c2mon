<?xml version="1.0" encoding="UTF-8"?>
<products>
   <product name="c2mon">

      <application name="default">
         <deployment>
            <backupPolicy keepBackups="2">
               <preserve type="dir" name="log" />
               <preserve type="dir" name="tmp" />
               <preserve type="file" name="conf/publisher.tid" />
            </backupPolicy>

         </deployment>
      </application>


      <application name="dmn2-publisher-rda3-pro" extends="default">
         <deployment installLocation="/opt/dmn2/dmn2-publisher-rda3">
            <notification>
               <!-- you can give more than one mail for deployment notification -->
               <mail address="project-diamon-core@cern.ch" />
            </notification>

            <directory name="conf">
               <!--
                  Copy over the c2mon-client.properties file into the /conf directory
               -->
               <file name="client.properties" sourceDir="~diamonop/c2mon/client" mask="400" />
               <file name="publisher.tid" sourceDir="~diamonop/c2mon/client/rdapublisher" mask="400" />
            </directory>
         </deployment>
         <startscript name="dmn2-publisher-rda3">
            <initial-heap-size>256m</initial-heap-size>
            <max-heap-size>256m</max-heap-size>

            <main-class name="cern.c2mon.publisher.core.PublisherKernel" />

            <!-- JVM arguments -->            
            <property name="c2mon.publisher.rda.server.name" value="DMN-RDA3-SERVER" /> <!-- Needed for setting the RDA server name -->
            <property name="c2mon.publisher.tid.location" value="${INSTALL_DIR}/conf/publisher.tid" />
            <property name="log4j.configuration" value="${INSTALL_DIR}/conf/log4j.xml" />
            <property name="c2mon.log.path" value="${INSTALL_DIR}/log" />
            <property name="c2mon.process.name" value="DMN2-RDA3-PUBLISHER" />
            <property name="c2mon.client.conf.url" value="file://${INSTALL_DIR}/conf/client.properties" />
            <property name="cmw.rda3.transport.server.multiThreadedPublisher" value="true" /> <!-- see also https://issues.cern.ch/browse/CMW-1812 -->
         </startscript>
      </application>


      <application name="dmn2-publisher-rda3-dev" extends="default">
         <deployment installLocation="/opt/dmn2/dmn2-publisher-rda3-dev">
            <directory name="conf">
               <!--
                  Copy over the c2mon-client.properties file into the /conf directory
               -->
               <file name="client.properties" sourceDir="~dmndev/c2mon/client" mask="400" />
               <file name="publisher.tid" sourceDir="~dmndev/c2mon/client/rdapublisher" mask="400" />
            </directory>
         </deployment>
         <startscript name="dmn2-publisher-rda3">
            <initial-heap-size>256m</initial-heap-size>
            <max-heap-size>256m</max-heap-size>

            <main-class name="cern.c2mon.publisher.core.PublisherKernel" />

            <!-- JVM arguments -->
            <property name="cmw.directory.client.serverList" value="cmw-dir-test:5021" /> <!-- force the rda3 server to bind to the TEST dir service -->
            <property name="c2mon.publisher.rda.server.name" value="DMN-RDA3-SERVER" /> <!-- Needed for setting the RDA server name -->            
            <property name="c2mon.publisher.tid.location" value="${INSTALL_DIR}/conf/publisher.tid" />
            <property name="log4j.configuration" value="${INSTALL_DIR}/conf/log4j.xml" />
            <property name="c2mon.log.path" value="${INSTALL_DIR}/log" />
            <property name="c2mon.process.name" value="DMN2-RDA3-PUBLISHER-DEV" />
            <property name="c2mon.client.conf.url" value="file://${INSTALL_DIR}/conf/client.properties" />

         </startscript>
      </application>

   </product>
</products>